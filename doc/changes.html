<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
		<head>
				<title>Cylc Change Log Summary</title>
				<link rel="stylesheet" href="changes.css">
		</head>

<body>

<div class="uberpage">
<div class="page">

<h1>Cylc Change Log Summary</h1>

<div class="rbox">
<h3 style="margin:10px">versions</h3>
<ul>
		<li><a href="#">TOP</a></li>
		<li><a href="#5.4.5">5.4.5</a></li>
		<li><a href="#5.4.4">5.4.4</a></li>
		<li><a href="#5.4.3">5.4.3</a></li>
		<li><a href="#5.4.2">5.4.2</a></li>
		<li><a href="#5.4.1">5.4.1</a></li>
		<li><a href="#5.4.0">5.4.0</a></li>
		<li><a href="#5.3.0">5.3.0</a></li>
		<li><a href="#5.2.0">5.2.0</a></li>
		<li><a href="#5.1.1">5.1.1</a></li>
		<li><a href="#5.1.0">5.1.0</a></li>
		<li><a href="#5.0.3">5.0.3</a></li>
		<li><a href="#5.0.2">5.0.2</a></li>
		<li><a href="#5.0.1">5.0.1</a></li>
		<li><a href="#5.0.0">5.0.0</a></li>
		<li><a href="#old">old</a></li>
</ul>
</div>

<p>This pages mainly lists major enhancements and bug fixes. Selected minor
bug fixes and changes may also be listed - for all changes see the
cylc git repository change log.</p>

<a name="5.4.5"/>
		<h2>5.4.5</h2>

		<ul>
				<li>Simplified polling for tasks submitted to <em>loadleveler</em>,
				<em>pbs</em>, <em>sge</em>, <em>background</em>, or <em>at</em>: </li>
				<ul>
						<li> <em>submitted</em> - job in the queueing system, but has no
						task status file. </li>
						<li> <em>submission failed</em> - job not in the queueing system, and has no
						task status file. </li>
						<li> <em>running</em> - job in the queueing system, and has a 
						task status file. </li>
						<li> <em>succeeded</em> or <em>failed</em> - job not in the queueing system but has a 
						task status file. </li>
				</ul>
				
				<p/>
				Additionally, an old task status file, if present, will be deleted at submission time.

				<li>More cylc daemon performance enhancements for large suites.</li>

				<li>The <code>cylc cat-log</code> command can now print remote task logs.</li>

				<li>Changed the <em>submitting</em> task state name to
				<em>ready</em> - meaning the task is ready to run and has been
				passed to the job submission thread in the cylc daemon.</li>

				<li>New User Guide sections under <em>Suite Design Principles:</em></li>
				<ul>
						<li> <em>Factor Out Common Configuration</em></li>
						<li> <em>Use the Graph for Scheduling</em></li>
						<li> <em>Use Suite Visualization</em> </li>
				</ul>

				<li>New User Guide section - <em>Style Guide</em> </li>

				<li>Added a command wrapper script, and documentation, to
				facilate use of multiple versions of cylc at once - so you can
				run new suites at new versions of cylc without having to upgrade
				existing long-running suites.</li>

				<li>Handle a known problem with the ext4 filesystem that could wipe
				out cylc state dump files in the event of a power failure. </li>

				<li>Graceful shutdown on loading a corrupted restart state dump file.</li>

				<li>Use the normal suite run directory for tasks executed by the 
				<code>cylc submit</code> command </li>


				<li>Moved some common log messages to debug level.</li>

		</ul>
	
<a name="5.4.4"/>
		<h2>5.4.4</h2>

		<ul>
				<li>New <code>[runtime][NAME][environment filter]</code> allows
				inherited variables to be explicitly included or excluded from
				task environments.</li>

				<li><code>cylc stop</code> command help improved.</li>

				<li>Shut down cleanly if access to the suite run directory is
				lost.</li>

				<li>Fixed graphing of suite start up when several subsequent
				cycles depend on an initial asynchronous task.</li>
		</ul>
	
<a name="5.4.3"/>
		<h2>5.4.3</h2>

		<ul>
				<li>The <code>cylc get-config</code> and <code>cylc
						get-global-config</code> commands now print blank values 
				instead of the Pythonic <code>None</code> for unset items. This
				means newly generated user config files are usable immediately
				without modification.</li>

				<li>Sensible suite-dependent defaults are now computed for the 
				<code>[visualization]</code> initial and final cycle times:
				from the suite's initial cycle time out to its default runahead
				limit</li>

				<li>For inlined editing of suites with include-files, the 
				file inclusion markers are now comments so that the suite
				definition can still be used (validated etc.) during the 
				edit session.</li>

				<li>Fixed a recent bug that breaks polling of tasks with  
				an explicit 'owner' configured (as opposed to defaulting 
				to the suite owner's username, or using <code>.ssh/config</code>
				to translate usernames for remote tasks). This bug would 
				break suite restart if any such tasks were present in the
				submitted or running states.</li>
		</ul>

	
<a name="5.4.2"/>
		<h2>5.4.2</h2>

		<ul>
				<li>Fixes a bug that could cause an error in gcylc if it tried
				to interrogate a very large suite before it had finished
				initializing.</li>

				<li>Allow the suite name delimiter '.' (dot) character in 
				the names of the new automatic suite-polling tasks.</li>

				<li>Fixed a recently introduced bug that caused the <code>cylc
						db refresh</code> command to crash if a suite's name had
						been changed.</li>

				<li>Fixed gcylc graph view right-click family Group/Ungroup 
				behaviour.</li>

				<li>Documented automatic suite-polling tasks (triggering off 
				tasks in other suites) in the user guide.</li>

				<li>Updated suite definition syntax documentation in the 
				user guide.</li>

				<li>Further expansion of the automated test battery.</li>

		</ul>
	

<a name="5.4.1"/>
		<h2>5.4.1</h2>

			<ul>
				<li>Fixes a bug introduced just before the 5.4.0 release: cylc 
				would abort if a task in a suite with no final cycle time hit 
				the runahead limit.
		   </ul>	

<a name="5.4.0"/>
		<h2>5.4.0</h2>

		<ul>
				<li>dependence on tasks before the initial cycle time is now
				ignored, so cold-start tasks are no longer strictly required
				in suites with inter-cycle dependence</li>

				<li>graph notation support for triggering off tasks in other suites</li>

				<li>a comprehensive new User Guide <em>Tutorial</em> section replaces
				the old <em>Quick Start Guide</em> </li>

				<li>a multi-suite summary gui, <code>cylc gsummary</code></li>

				<li>a new <code>submit-retry</code> task state (the
				<code>retry</code> state is now exclusively for execution retry)</li>

				<li>processed suite definitions are now written out to the suite directory</li>

				<li>a simpler and more robust suite name registration database 
				(to upgrade run <code>cylc upgrade-db</code>)</li>

				<li>many performance enhancements for large suites</li>

				<li>gcylc</li>
				<ul>
						<li> single updater thread for multiple suite views</li>
						<li> updates only if the suite state has changed (lower network traffic)</li>
						<li> optional transposed dot view</li>
						<li> clickable suite error notification in the task bar</li>
						<li> in the graph view, runahead tasks and tasks held beyond
						the suite final cycle time - and potentially many base graph
						nodes to join the graph - are now cropped by default.</li>
				</ul>

				<li>extract specific site/user config items with <code>cylc
				get-global-config</code></li>

				<li>replaced ConfigObj with a faster custom config file parser and
				validator, "parsec"</li>

				<li>repeated sections and items are now allowed in suite definitions</li>

				<li>task poll and kill for Sun Grid Engine (other job submission
				methods got this at 5.3.0)</li>

				<li><code>cylc cat-log</code> now prints task as well as suite logs</li>

				<li>a greatly expanded automated test battery using a new Perl
				<code>prove</code>-based framework</li>

				<li>support added for the Jinja2 <code>do</code> extension
				(allows manipulation of data structures without having to
				<code>set</code> a variable)</li>

				<li><code>cylc graph</code> now has a "save image" GUI button (previously a
				command line option had to be used to generated image files)</li>

				<li>improved <code>cylc trigger</code> semantics: manual
				triggering now results in immediate job submission if the target
				task does not belong to a limited queue or if it is already
				queued, otherwise it will queue the task immediately.</li>

				<li>stop queued job submissions immediately if a shutdown is
				requested</li>

				<li>deprecated the <code>--owner</code> command option to
				<code>--user</code> and documented more clearly that use of 
				this and <code>--host</code> results in command re-invocation on
				the remote account</li>

				<li>if an owner is not specified for a task <code>$USER</code>
				is no longer assumed - this allows remote username translation
				to be done via <code>$HOME/.ssh/config</code> 

				<li>many many bug fixes, including:</li>
				<ul>
						<li> the order of cycling graph sections of different kinds (e.g.
						Daily and Monthly in the same suite) no longer matters </li>

						<li>Monthly cycling now works properly even if the initial
						cycle time is off-sequence</li>

						<li>respect the <code>[visualization]collapsed families</code>
						suite config item for the initial graph view</li>

				</ul>


		</ul>
	

<a name="5.3.0"/>
		<h2>5.3.0</h2>

		<ul>
				<li>New <code>submit</code> and <code>submit-fail</code> task
				triggers.</li>

				<li>The EVENT argument passed to event handler scripts now
				matches the suite.rc item names exactly (no replacement of
				spaces with underscores, e.g. in "submission timeout".</li>

				<li>Automatic polling as a task communication mechanism for task
				hosts that do not allow return messaging by network socket
				(Pyro) or ssh.</li>

				<li>On-demand job poll and kill by CLI and GUI.</li>

				<li>Automatic job poll on task job submission and execution
				timeouts.</li>

				<li>Automatic job polling on restarting a suite, to find out
				what happened to any orphaned tasks while the suite was
				down.</li> 

				<li>Fixed ksh compatibility in task job scripts.</li>

				<li>All gcylc views start in family-grouped mode.</li>

				<li>Optionally ignore suicide triggers in suite graphs and 
				the gcylc graph view.</li>

				<li>Delay between job submission batches set to zero by default.</li>

				<li>Option to kill active tasks before shutdown.</li>

				<li>Support for "future triggers": <code>foo[T+24] => bar</code></li>

				<li>Better spent task proxy clean-up algorithm.</li>

				<li>Allow manual triggering of tasks that are retrying.</li>

		</ul>

<a name="5.2.0"/>
		<h2>5.2.0</h2>

		<ul>
				<li><b>gcylc can now switch between suites</b> - the 
				former <code>cylc dbviewer</code> GUI has been converted to a
				"File Open" dialog for gcylc.</li>

				<li><b>Preparation commands</b> (validate, graph, etc.) can now take
						a suite definition path instead of a registered suite name.</li>

    		<li><b>Control commands</b> can now operate on multiple tasks at once,
				selecting by family name or regular expression.</li>

				<li><b>A new task state</b> to distinguish submission failure from 
						execution failure.</li>

				<li> Configurable <b>job submission retry</b>.</li>

				<li>A poll-and-wait option for the <b>stop command</b>.</li>

				<li><b>Orphaned running tasks</b> can now reconnect to a
				restarted suite, even if it starts on a different port.</li>

				<li>Automatic suite <b>run-directory housekeeping</b>.</li>

				<li>The final path component of a <b>task work directory</b> can
				now be set in the suite definition. This restores the pre cylc-5
				ability to allow groups of interdependent tasks that all read
				and write from their current working directories to be given a
				common file share space.</li>

				<li>The ssh connection now remains open while <b>remote background
						tasks</b> run, for sites that automatically kill detached
				processes on login nodes.</li>

				<li>Restored <b>dynamic host selection by environment variable</b>.</li>

				<li><b>Suicide triggers</b> can now be applied to task families.</li>

				<li>Interactive <b>command prompts</b> have been disabled by default.</li>

				<li>Dropped support for <b>Python 2.4.</b></li>

				<li><b>UTC mode</b> now sets <code>$TZ</code> in task environments.</li>

				<li>The <b>test battery</b> now cleans up temporary files after
				itself, and it has been parallelized.</li>

				<li> <b>syntax hilighting</b> for the <b>kate</b> editor.</li>

				<li>Access to the new <b>suite run-db</b> is now retried several
				times in case of an unlikely access conflict.</li>

				<li>A first-parent namespace can now be demoted to prevent its
				use as the visualization family (e.g. 
				<code>inherit = None, myparent</code> will keep the namespace 
				under root for visualization purposes).</li>

				<li><code>cylc list</code> command output has been updated
				for multiple inheritance, and the option to print namespace
				(task and family) title information has been restored.</li>

				<li>Cylc can now be invoked via symlinked directories in
				<code>$PATH</code>.</li>

		</ul>

<a name="5.1.1"/>
		<h2>5.1.1</h2>

		<ul>
				<li>Restored use of visualization settings, broken by
				the task ID delimiter change in 5.0.0.</li>

				<li>Restored <b>image file output</b> capability to the gcylc
				suite graph dialog.</li>
		</ul>

<a name="5.1.0"/>
		<h2>5.1.0</h2>

<ul>

		<li>Added <b>site/user config file documentation</b> to the User
		Guide.</li>

		<li>The <b>task ID delimiter has changed</b> from '%' to '.'
		(foo%2013080800 becomes foo.2013080800) because the '%' character
		causes trouble for web-based suite output viewers. This affects task
		IDs on the command line, and task log filenames, but it does not affect
		 suite definitions.</li>

		<li> Updated several example suites that were not validiting after recent changes.</li>

		<li><b>Multiple inheritance</b> for the runtime namespace hierarchy.</li>

		<li><b>A new command</b> <code>cylc [util] suite-state</code> queries the
		new suite run databases for task state, and in a polling mode can be
		used by tasks to wait on tasks in other suites.</li>

		<li>New <b>task job status files</b> in the task job log directory
		are updated by running tasks. In the future this will allow cylc to
		determine, on restarting, what happened to running tasks that were
		orphaned when the suite was down.</li>
</ul>


<a name="5.0.3"/>
		<h2>5.0.3</h2>

<ul>
		<li><b>Create many fewer temporary directories.</b></li>
</ul>

<a name="5.0.2"/>
		<h2>5.0.2</h2>

<ul>
		<li> <b>Bug fix for warm starts</b> - a function <code>plog()</code>
		that no longer exists was called on warm starting.</li>

		<li> <b>Bug fixes for doc/Makefile:</b> - "make clean" was not
		working, and a fatal error occured if htlatex was not installed.</li>

</ul>


<a name="5.0.1"/>
		<h2>5.0.1</h2>

<ul>
		<li> <b>Bug fix for 5.0.0 batched job submission:</b> a job
		submission failure would cause cylc to abort.</li>

		<li> <b>Changed "log root" filenames</b> (i.e. task job script plus
		stdout and stderr logs, and <code>$CYLC_TASK_LOG_ROOT</code>
		in task environments): replaced seconds-since-epoch with a simple
		<i>submit number</i> that increments on retries and manual
		triggering.</li>

		<li> Added a suite definition <b>syntax file</b> for the
		<b>gedit</b> editor and other gtksourceview programs:
		<code>conf/cylc.lang</code>.</li>

</ul>

<a name="5.0.0"/>
<h2>5.0.0</h2>

<ul>
		<li> <b>Multi-threading</b>: cylc now does continous request
		handling, batched task job submission, and batched event handler
		execution, in background threads. This has big performance
		benefits for large, busy, suites.</li>

		<li> Cylc now runs in <b>daemon mode</b> - no need to use nohup
		anymore.</li>

		<li> <b>Major change in suite restart behavior</b>: tasks recorded
		in the submitted, running, or failed states are no longer triggered
		automatically on restarting, because that is not always desirable.</li>

		<li> A new command can <b>broadcast runtime settings to tasks in
		a running suite</b>, overriding their configured settings. One way to
		use this: <b>tasks can communicate environment variables to other
				tasks downstream of them</b>.  Broadcast settings persist across
		restarts.</li> 

		<li> <b>Reloading the suite definition at run time</b> is now
		supported. Even task definitions can be added and removed without
		stopping and restarting the suite.</li>

		<li> <b>Restarting after deleting task definitions</b> now works 
		without modifying the state dump.</li>

		<li> <b>Dynamic host selection</b> is officially supported.</li>

		<li> New <b>family trigger syntax</b> allows any family finish
		semantics, with use of conditional operators.</li>

		<li> Higher level <b>family triggers</b> (families of
		families) can now be used in the graph.</li>

		<li> New <b>site and user config files</b> some former suite
		definition items, and other global settings, can now be configured 
		globally.</li> 

		<li> The <b>runahead limit</b> now automatically defaults to the
		twice the smallest cycling interval in a suite, and setting it too
		low can no longer stall a suite.</li>

		<li> <b>Self-diagnosing test suites</b> can now be created to test
		that cylc upgrades will not break your systems; see
		"Reference Tests" in the User Guide.</li> 

		<li> The <b>suite control GUI "gcontrol" has been renamed
				"gcylc"</b> as it now has suite preparation capability too
		(editing, graphing, validating, etc.); the former "gcylc" GUI is
		still available as <code>cylc dbviewer</code>.</li>

		<li> Configurable <b>gcylc task state color themes</b> common to all
		views.</li>

		<li> The <b>gcylc dot view</b> now has hover-over task state
		information, and right-click menus.</li>

		<li> The <b>gcylc graph view</b> now has:
		<ul>
				<li> <b>family node</b> state coloring and mouse-hover member
				state information</li>
				<li> <b>landscape mode</b></li>
				<li> <b>reduced redraw</b> (i.e. the graph jumps around less)</li>
				<li> <b>"cycle time focus"</b> now works (broken between 4.2.2 and 4.5.1)</li>
		</ul>
		</li>

		<li> <b>gcylc: less frequent polling</b> for stopped suites, to
		reduce network traffic. A polling reset button can be used to
		reconnect to a restarted suite immediately.</li>

		<li> <b>Undefined Jinja2 variables</b> now cause an abort.</li>

		<li> <b>Set Jinja2 variables on the run command line</b>
		(in-line or by referencing an external file).</li>

		<li> <b>Removed pseudo backward compatibility</b>
		(<code>#!cylc-x.y.z</code>).  We will endeavor
		to provide proper backward compatibility from now on.</li>

		<li> Configurable <b>task messaging retry</b> for resilience to
		network outages etc.</li>
		
		<li> <b>Task messaging failure</b> no longer causes tasks to abort.</li>

		<li> <b>ssh task messaging</b>: the path to cylc on the suite host
		is now transferred via the task job script (no need to rely on 
		login scripts).</li>

		<li> A new <b>task retry event hook</b> is triggered if a task fails
		but has a retry lined up. The <b>task failed event hook</b> is only
		triggered on a final definitive failure.</li>

		<li> Handling <b>HPC job preemption:</b> Tasks can be configured 
		to revive from the dead if they start running again after reporting
		failure.</li>

		<li> A new config item to <b>abort a suite if any task fails</b>.</li>

		<li> Removed the requirement to prefix the integer TAG of an
		asynchronous (non-cycling) task, on the command line, with <b>a:</b>.</li>

		<li> Added <b>suite event hooks</b> for suite <b>startup</b> and
		<b>shutdown</b>.</li>

		<li> Replaced the original <b>simulation mode</b> which submitted
		real dummy tasks to run locally with a proper <b>simulation mode</b>
		that does not even submit dummy tasks, and a <b>dummy mode</b>
		that simply dummies out command scripting but leaves job
		submission, hosting, etc. intact.</li>

		<li> Tasks can check <b>$CYLC_TASK_IS_COLDSTART</b> to determine
		whether or not they are cold-start tasks.</li>

		<li> A new <b>strict validation</b> option protects against
		inadvertent creation of naked dummy tasks (tasks with no explicit
		runtime config) by misspelling task names.</li>

		<li> Optional <b>suite host identification by IP address</b> instead
		of host name.</li>

		<li> A suite-specific <b>sqlite database</b> is populated by
		cylc with task event and status information. Planned future uses
		include retrieval of information about long-finished tasks, and
		replacing the current primitive state dump files.</li>

		<li> Allow <b>(number-of-retries)*(delay)</b> notation in task
		<b>task retry</b> configuration.</li>

		<li> The <b>cylc doc</b> command now loads a documentation index in
		your browser.</li>

		<li> Suite <b>block/unblock</b> functionality has been removed.</li>

		<li> Optionally <b>disable use of a login shell</b> in
		passwordless ssh remote command invocation (e.g. to submit
		remote tasks). </li>

		<li> The task execution environment variables
		<b>$CYLC_SUITE_INITIAL_CYCLE_TIME</b> and
		<b>$CYLC_SUITE_FINAL_CYCLE_TIME</b> now persist across restarts.</li>

</ul>

<a name="old"/>
<h2>Old Change Log (4.5.1 and earlier)</h2>
<ul>
		<li>	<a href="changes-old.txt">(doc/changes-old.txt)</a> </li>
</ul>


</div> <!--uberpage-->
</div> <!--page-->

</body>
</html>

