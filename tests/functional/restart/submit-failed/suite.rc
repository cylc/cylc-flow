#!jinja2
{%- set TEST_DIR = environ['TEST_DIR'] %}
# TODO SoD: added new "remove" tasks to get rid of submit-failed one and allow
# shutdown, in lieu of suicidge triggers.  What's the best way to handle this?
[cylc]
    UTC mode = True
    [[events]]
        abort on timeout = True
        timeout = PT3M
[scheduling]
    initial cycle point = 20130923T00
    final cycle point   = 20130923T00
    [[graph]]
        R1 = """
            submit_failed_task:submit-fail => shutdown
            shutdown => output_states
            output_states => remove => finish
        """
[runtime]
    [[submit_failed_task]]
        script = """
            exit 1  # Should not submit, so this shouldn't run!
        """
        platform = test platform
        [[[meta]]]
            description = "Submit-failed task (runs before restart)"
    [[remove]]
          script = """
 cylc remove ${CYLC_SUITE_NAME} submit_failed_task.${CYLC_TASK_CYCLE_POINT}
                   """
{% include 'suite-runtime-restart.rc' %}
